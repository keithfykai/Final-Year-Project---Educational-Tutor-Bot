## Chapter 8: Correlation and Regression

[Prepared by: Mr Leong Chong Ming & Mr Chen Jianda Alvin]

At the end of this chapter, students should be able to

* use a scatter diagram to judge if there is a plausible linear relationship between two variables
* calculate and interpret the product moment correlation coefficient as a measure of the fit of a linear model to the scatter diagram
* find the equation of the least-squares regression line
* use the appropriate regression line to make prediction or estimate a value in practical situations (interpolation and extrapolation), and explain how well the situation is modelled by the linear regression model
* use a square, reciprocal or logarithmic transformation to achieve linearity

### Terminology

#### 8.1.1 Dependent and Independent Variables

In statistics, **bivariate data** is data that has two variables. The following table shows 4 sets of bivariate data \(x\) and \(y\). Is there any relationship between each pair of variables?

\begin{tabular}{|l|l|} \hline \(x\) & \(y\) \\ \hline Student's Math Score & Student's Physics Score \\ \hline Age of a tree & Trunk circumference \\ \hline Length of leg of a student & Distance jumped by a student \\ \hline Monthly advertising expenditure & Monthly sales \\ \hline \end{tabular} In a bivariate pair, an **independent variable** is a variable whose variation does not depend on that of another. In an experiment, the independent variable would be the one which you have "control" over, thus allowing you to vary its value to determine the value of the corresponding **dependent variable**.

It may be possible to identify _from context_ the independent variable and the dependent variable. For example, if we are investigating how the length of a pendulum will affect its period of swing, then the length of the pendulum will be the **independent** variable and its period will be the **dependent** variable.

The following table shows another set of bivariate data.

\begin{tabular}{|l|l|l|l|l|l|l|l|l|} \hline \(x\) & 10 & 20 & 30 & 40 & 50 & 60 & 70 & 80 \\ \hline \(y\) & 20 & 21 & 23 & 24 & 23 & 25 & 28 & 29 \\ \hline \end{tabular} The values of \(x\) varies at a _fixed increment_. This is another indication that \(x\) is likely to be the **independent** variable (controlled) and \(y\), the **dependent** variable. If context is provided, the fact that \(x\) increases at fixed intervals would give further evidence that it is the independent variable. Usually, the independent variable will be listed in the first row of the table.

**Example 1**:
**(a)**: A botanist wishes to investigate the effects of artificial light on the growth of a certain type of plant. A random sample of 7 seeds of the plant species is planted in 7 different pots and the amount of artificial light per day given to each pot is varied. The following results are recorded after a period of 14 days:

\begin{tabular}{|l|l|l|l|l|l|} \hline Amount of artificial light & 4 & 8 & 10 & 13 & 14 & 17 & 18 \\ per day ( \(l\) hours) & & & & & & \\ \hline Height of plant ( \(h\) cm) & 6 & 8 & 10 & 11 & 14 & 14 & 15 \\ \hline \end{tabular} State the independent variable and the dependent variable (if any), justifying your choice.

**Solution:**

The variable \(l\) is the independent variable and the variable \(h\) is the dependent variable since the investigation is on how the height of the plant, \(h\) cm, depended on the amount of artificial light per day, \(l\) cm, it received.

**(b)**: Eight newly-born babies were randomly selected. Their head circumference, \(x\) cm, and body length, \(y\) cm were measured by the pediatrician and tabulated.

\begin{tabular}{|l|l|l|l|l|l|l|l|} \hline \(x\) & 31 & 32 & 33.5 & 34 & 35.5 & 36 & 36.5 & 37.5 \\ \hline \(y\) & 45 & 49 & 49 & 47 & 50 & 53 & 51 & 51 \\ \hline \end{tabular} State the independent variable and the dependent variable (if any), justifying your choice.

**Solution:**

There is no independent and dependent variable as it is not clear from context if head circumference is dependent on body length or vice versa.

[MISSING_PAGE_FAIL:3]

[MISSING_PAGE_EMPTY:4]

## Chapter 2 Strength

\begin{tabular}{|p{142.3pt}|p{142.3pt}|} \hline \multicolumn{1}{|c|}{} & \\ \hline If the data points are close to a straight line, & If the data are not clustered near a straight line, \\ there is a **strong** linear correlation between \(x\) and \(y\). & then the linear correlation between \(x\) and \(y\) may not be strong. \\ \hline
3 & **Direction:** The two variables \(x\) and \(y\) can be positively correlated, negatively correlated or not correlated at all: This relationship is usually described in the context of the situation. \\ \hline \(x\) & \(y\) generally increases as \(x\) increases, then \(x\) and \(y\) are **positively** correlated. \\ \hline \(y\) generally decreases as \(x\) increases, then \(x\) and \(y\) are **negatively** correlated. \\ \hline \end{tabular}

**Suggested interpretation of a scatter plot with curvilinear trend**

The following scatter plots are for \(y\) against \(x\).

\begin{tabular}{|p{142.3pt}|p{142.3pt}|} \hline \multicolumn{1}{|c|}{} & \\ As \(x\) increases, \(y\)_increases_ at an _increasing_ rate. & As \(x\) increases, \(y\)_decreases_ at an _increasing_ rate. \\ \hline \end{tabular}

As \(x\) increases, \(y\)_decreases_ at a _decreasing_ rate.

\begin{tabular}{|p{142.3pt}|p{142.3pt}|} \hline \multicolumn{1}{|c|}{} & \\ As \(x\) increases, \(y\)_decreases_ at a _decreasing_ rate. & As \(x\) increases, \(y\)_decreases_ at an _increasing_ rate. \\ \hline \end{tabular}

**Outliers**

An **outlier** is an observation that lies outside the overall pattern of the data: Outliers may arise due to error in experiment or data capture, or simply reflect anomalies that had occurred naturally. A scatter diagram can help to identify outliers.

\begin{tabular}{|p{142.3pt}|p{142.3pt}|} \hline \multicolumn{1}{|c|}{} & \\ \hline \multicolumn{1}{|c|}{} & \\ \hline \multicolumn{1}{|c|}{} & \\ \hline \multicolumn{1}{|c|}{} & \\ \hline \multicolumn{1}{|c|}{} & \\ \hline \multicolumn{1}{|c|}{} & \\ \hline \multicolumn{1}{|c|}{} & \\ \hline \multicolumn{1}{|c|}{} & \\ \hline \multicolumn{1}{|c|}{} & \\ \hline \multicolumn{1}{|c|}{} & \\ As \(x\) increases, \(y\)_decreases_ at a _decreasing_ rate. & As \(x\) increases, \(y\)_decreases_ at an _increasing_ rate. \\ \hline \end{tabular}

**Outliers**

An **outlier** is an observation that lies outside the overall pattern of the data: Outliers may arise due to error in experiment or data capture, or simply reflect anomalies that had occurred naturally. A scatter diagram can help to identify outliers.

\begin{tabular}{|p{142.3pt}|p{142.3pt}|} \hline \multicolumn{1}{|c|}{} & \\ As \(x\) increases, \(y\)_decreases_ at an _increasing_ rate. \\ \hline \end{tabular}

**Outliers**

An **outlier** is an observation that lies outside the overall pattern of the data: Outliers may arise due to error in experiment or data capture, or simply reflect anomalies that had occurred naturally. A scatter diagram can help to identify outliers.

\begin{tabular}{|p{142.3pt}|p{142.3pt}|} \hline \multicolumn{1}{|c|}{} & \\ As \(x\) increases, \(y\)_decreases_ at an _increasing_ rate. \\ \hline \end{tabular}

**Outliers**

An **outlier** is an observation that lies outside the overall pattern of the data: Outliers may arise due to error in experiment or data capture, or simply reflect anomalies that had occurred naturally.

**Chapter S8 Correlation and Regression**

**Self-Review 1:**

The table below shows the ages in years (\(x\)) and the trunk circumferences in cm (\(y\)) of a random sample of 7 trees of a particular species.

\begin{tabular}{|l|c|c|c|c|c|c|c|c|} \hline Age (\(x\)) & 11 & 13 & 21 & 28 & 34 & 42 & 45 & 51 \\ \hline Circumference (\(y\)) & 24.4 & 32.1 & 52.8 & 78.3 & 79.2 & 25.1 & 102.7 & 121.2 \\ \hline \end{tabular}

Give a sketch of the scatter diagram for the data, as shown on your calculator.

One of the points appears to be wrongly recorded. Indicate the corresponding point on the diagram by labelling it \(P\).

**Solution:**

**ThinkZone:**

\begin{tabular}{|l|l|} \hline \(\bullet\) & Are the axes labelled? It \\ suffices to label the smallest \\ (need not start from 0) and \\ largest values for each axis. \\ \(\bullet\) & Is the diagram drawn to \\ scale? Use GC to help \\ gauge the range of values. \\ \(\bullet\) & Are the data points marked \\ with a cross '\(\star\)'? \\ \end{tabular}

Note: Point P is called an outlier.

### Linear Correlation and Product Moment Correlation Coefficient, \(r\)

In statistics, **correlation** is the measure of relationship between 2 variables, and this is represented by a number called the correlation coefficient. For our syllabus, we will focus on **linear correlation**.

The **product moment correlation coefficient**, \(r\), which indicates the **linear degree** of scatter, is a measure of the **linear relationship** between 2 random variables \(X\) and \(Y\).

The **product moment correlation coefficient**, \(r\), is defined by:

\[r=\frac{\sum(x-\overline{x})(y-\overline{y})}{\sqrt{\left(\sum(x-\overline{x} )^{2}\right)\left(\sum(y-\overline{y})^{2}\right)}}=\frac{\sum x\overline{y}- \sum x\overline{y}}{n}\]

[in MF 27]

\[\sqrt{\left[\left(\sum x^{2}-\frac{\left(\sum x\right)^{2}}{n}\right)\left( \sum y\right)^{2}\right)}\]

**Note:**

**(i)** The value of \(r\) (\(-1\leq r\leq 1\)) indicates the **strength** and **direction** of the linear relation.

\begin{tabular}{|l|l|l|l|l|} \hline \(r=1\) & A **perfect positive linear** & All the data points lie on a straight line with \\  & relationship between \(x\) and \(y\). & positive gradient. \\ \hline \(r>0\) & A **positive linear** relationship & As \(x\) increases, \(y\) increases. \\  & between \(x\) and \(y\). & & \\ \hline \(r=0\) & **No linear relationship** between & Note that no linear relationship does not imply \\  & \(x\) and \(y\). & no relationship as there could be a nonlinear relationship. \\ \hline \end{tabular}

**(iv)**: The following table gives a suggested range of values of \(r\) and its corresponding interpretation for two variables \(x\) and \(y\).
**(v)**: A strong linear correlation between two variables does not necessarily imply that one variable directly causes the other.
**(vi)**: The value of \(r\) should always be interpreted together with a scatter diagram where possible. The value of \(r\) can also be affected by outliers and can give a misleading conclusion on the linear correlation of two variables. For example, the following 3 diagrams have the same value of \(r=0.816\) but appeared differently when graphed.

**Example 3**:

Seven students from a class were selected. The number of days of absence and their corresponding final grades were recorded as follows:

\begin{tabular}{|l|c|c|c|c|c|c|c|} \hline Student & 1 & 2 & 3 & 4 & 5 & 6 & 7 \\ \hline No. of days of absence, \(x\) & 10 & 12 & 2 & 0 & 8 & 5 & 3 \\ \hline Final grade, \(y\) \% & 70 & 65 & 96 & 94 & 75 & 82 & 88 \\ \hline \end{tabular}

Calculate the product moment correlation coefficient between \(x\) and \(y\).

**GC Keystrokes:**

Enter the data into the calculator :

**Step1**: Press [stat]and select **1:Edit**.

\begin{tabular}{|l|} \hline Put the \\ independent \\ variable in L\({}_{1}\) \\ \end{tabular}

\begin{tabular}{|l|} \hline Set 2: Press [stat], select the **CALC** menu \\ and select **4: LinReg(ax+b)**, Press [enter] \\ \hline Key in L\({}_{1}\) into the Xlist: \\ Scroll down to **Calculate** and press [enter] \\ \hline \end{tabular}

**Note:** Xlist and Ylist are the list of values that the GC will use for the horizontal and vertical axes respectively.

The choice of L\({}_{1}\) in Xlist and L\({}_{2}\) in Xlist of L\({}_{2}\) in Xlist and L\({}_{1}\) in Ylist is important for the regression (best-fit) line which we will discuss in the next section. However, either choice will give the same \(r\) value. (Why is this so?)

(To see the value of \(r\), you need to turn Stat Diagnostic ON. By default, Stat Diagnostic would be switched on when you reset your GC. Press [mode]and scroll down to STAT DIAGNOSTICS and select ON to turn it on otherwise.)

**Solution:**

Using GC, \(r=-0.982\) (3 significant figures)

This suggests a strong negative linear relationship between the number of days of absence and the students' final grade.

**Chapter S8 Correlation and Regression**

**Example 4**

Given the following set of bivariate data, draw a scatter diagram and calculate the product moment correlation coefficient between \(x\) and \(y\).

\begin{tabular}{|l|c|c|c|c|c|c|c|c|c|c|} \hline \(x\) & 1 & 1 & 1 & 2 & 2 & 2 & 3 & 3 & 3 & 9 \\ \hline \(y\) & 1 & 2 & 3 & 1 & 2 & 3 & 1 & 2 & 3 & 8 \\ \hline \multicolumn{10}{|l|}{**Solution:**} \\ \hline \end{tabular}

**Note:**

The point (9, 8) is an outlier. Without this point, we will have \(r=0\) (check for yourself using the GC).

This example shows that the product moment correlation coefficient by itself is insufficient to make a conclusion on the linear correlation (if any) between two variables. A scatter diagram should be used to visually determine if there is any linear correlation before the product moment correlation coefficient is calculated to quantify the correlation.

When interpreting the relationship between two variables, we may be asked to discuss the relationship based on -

\(\bullet\) a scatter diagram only, or

\(\bullet\) the value of \(r\) only, or

\(\bullet\) both a scatter diagram and the value of \(r\).

#### Scaling and/or Translation of Variables

It is not uncommon to rewrite one (or both) of your variables in a different form. For example, the data collected may have been captured with a specific unit of measurement, and needs to be rewritten in a different unit of measurement.

If the transformation required involves scaling and/or translation, the new set of transformed data will have the **same** product moment correlation coefficient. The following table shows some examples of a change in units that employs such transfomations:

\begin{tabular}{|l|l|c|} \hline
**Original units, \(x_{1}\)** & **New units, \(x_{2}\)** & **Conversion** \\ \hline Kilogram (kg) & Gram (g) & \(x_{2}=1000x_{1}\) \\ \hline Degree Celsius (\({}^{\circ}\)C ) & Degree Fahrenheit (\({}^{\circ}\)F ) & \(x_{2}=\frac{9}{5}x_{1}+32\) \\ \hline Metre (m) & Foot (ft) & \(x_{2}=3.28084x_{1}\) \\ \hline \end{tabular}

**Chapter S8 Correlation and Regression**

**Example 5** [N2000/II/6]

The amount, \(x\) grams, of catalyst used in a chemical reaction and the corresponding time, \(y\) hours, taken to complete the reaction were recorded. The results are given in the following table.

**Note:** From context, the variable \(x\) (amount of catalyst used in a chemical reaction) increases at fixed intervals and is the independent variable. The variable \(y\) (resulting time taken to complete the reaction) is the dependent variable.

**(a)**: Calculate the value of the linear (product moment) correlation coefficient for the data.
**(b)**: State what your value indicates about the relation between \(x\) and \(y\).
**(c)**: Plot a scatter diagram for the data and explain how its shape is related to your answer to part (b).
**(d)**: Without doing further calculation, how would the value of linear (product moment) correlation coefficient change if **(i)** the amount of catalyst is recorded in kilogram,
**(ii)**: each value of \(x\) is increased by 1.0 grams.

**Solution:**

**(a)**: The product moment correlation coefficient, \(r\) = -0.925 (3 s.f.)
**(b)**: The value of \(r\) suggests that there is a strong negative linear relationship between the amount of catalyst used and the time taken to complete the reaction.
**(c)**: Since \(r\) is close to \(-1\), it suggests a linear model is appropriate. However, the scatter diagram shows that the relationship is non-linear: as the amount of catalyst (\(x\) grams) used increases, the time taken to complete the reaction decreases at a decreasing rate. The data point at (4.5, 37.3) appears to be an outlier.
**(d)**: There will be no change in the value of \(r\) in both cases.
**(i)**: A change in the units for the variable corresponds to a scaling and the degree of linearity is not affected by scaling.
**(ii)**: Increasing each value of \(x\) by the same value corresponds to a translation and the degree of linearity is not affected by translation.

### 8.3 Linear Regression

**Correlation** is used to decide if there is a relationship between two variables and to determine how strong such a relationship is. **Regression** is used to find a model for the relationship and to estimate values of one variable given values of the other variable. After obtaining the scatter diagram, we may be interested to look for a mathematical relationship \(y=\mathrm{f}\left(x\right)\), i.e. by using the given points only, we have to 'work backwards' or'regress' to find a function \(\mathrm{f}\) that fits the given data. Hence the function is called the **regression function**.

If the scatter diagram and the linear product moment correlation coefficient between two variables gives a good indication that it is meaningful to model the observed data with a straight line, we may then attempt to fit a linear model in the form of a regression line, i.e. \(y=a+bx\) for some real constants \(a\) and \(b\).

### 8.3.1 Method of Least Squares

The **method of least squares** is the simplest and most applied form of linear regression to find the best fitting straight line through a set of data points. A best fit line obtained using this method is called a **least-squares regression line**. Two possible best fit lines can be found - the **least-squares regression line of \(y\)** on \(x\), and the **least-squares regression line of \(x\) on \(y\)**.

#### 8.3.1.1 Least-Squares Regression Line of \(y\) on \(x\)

Let \(\left(x_{1},y_{1}\right),\)\(\left(x_{2},y_{2}\right).\)\(\left(x_{n},y_{n}\right)\) be a set of \(n\) observed data points and let \(y=a+bx\) be the **least-squares regression line of \(y\) on \(x\)**.

Define **residuals** (or **errors**), \(\delta y_{i},\)\(i=1,2,...,n,\) as the deviation between the actual and fitted (predicted) values, i.e. the vertical distances drawn from each observed data point to the regression line with

\[\delta y_{i}=\text{observed value}-\text{predicted value}=y_{i}-\left(a+ \bar{bx}_{i}\right).\]

When we fit a line through the data, some of the actual values will be larger than their predicted values (they fall above the line and \(\delta y_{i}>0\)) and some of the actual values will be smaller than their predicted values (they fall below the line and \(\delta y_{i}<0\)).

To measure overall error and avoid cancellation of errors, we square the errors and find a line that minimises the sum of the squared errors, \(\sum_{i=1}^{n}\left(\delta y_{i}\right)^{2}=\delta y_{1}^{\ 2}+\delta y_{2}^{\ 2}+...+\delta y_{n}^{\ 2}.\)

[MISSING_PAGE_FAIL:12]

**Chapter S8 Correlation and Regression**

**Using Graphing Calculator to obtain Regression Line of \(y\) on \(x\)**

**Example 6**

Delegates who travelled by car to a conference were asked to report the distance they travelled and the time taken. The table below shows the data collected.

\begin{tabular}{|l|c|c|c|c|c|c|c|c|c|} \hline Distance, \(y\) (km) & 113 & 14 & 98 & 130 & 75 & 120 & 143 & 55 & 127 \\ \hline Time, \(x\) (min) & 130 & 25 & 180 & 148 & 100 & 120 & 196 & 48 & 165 \\ \hline
**(a)** & Obtain the equation of the regression line for \(y\) on \(x\).

**(b)** & Sketch the scatter diagram with the regression line for \(y\) on \(x\).

**(c)** & Estimate the distance travelled (to the nearest whole number) if a delegate took 150 minutes for the journey.

**(d)** & Interpret the coefficient of regression of \(y\) on \(x\) in the context of the question.

**Solution:**

Step \(\tt{I}_{x}\) Press (stat), select 1;Edit.

Key in the values of \(x\) in list \(\tt{L}_{1}\) and \(y\) in \(\tt{L}_{2}\).

**(Remark: 8:LinReg(a+bx) will also give the same regression line, but the role of \(\bf{a}\) and \(\bf{b}\) are swapped.)**

Step 2: Press (stat), select **CALC** and scroll down to select **4:LinReg(ax+b)**.

**(Remark: 8:LinReg(a+bx) will also give the same regression line, but the role of \(\bf{a}\) and \(\bf{b}\) are swapped.)**

Step 3: Key in \(\tt{L}_{1}\) into the Xlist

Key in \(\tt{L}_{2}\) into the Ylist

Key in \(\tt{Y}_{1}\) into StoreRegEQ

(Y\({}_{1}\) is selected by pressing [alpha] (trace))

Scroll to **[Calculate]** and press (enter) to obtain the regression line \(y\) on \(x\)

Note: Xlist and Ylist are the list of values that the GC will use for the horizontal and vertical axes respectively.

We plot the regression line of \(y\) on \(x\) on a scatter diagram with the usual \(x\)- and \(y\)-axes. Hence we select \(\tt{L}_{1}\) (\(x\) values) for Xlist and \(\tt{L}_{2}\) (\(y\) values) for Ylist.

**(a)** & The equation of the regression line for \(y\) on \(x\) is \(y=0.647x+17.3\) \\ \hline
**(b)** & To obtain the scatter diagram with the regression line, make sure that the STAT PLOT 1 is turned on and press [ZOOM] [9] to get the plot.)

**Important Note:** In general, the _regression line may not pass through the data points_. Thus if there is a missing data, we **CANNOT use the regression line to determine the missing data**. We must make use of \(\left(\overline{x},\,\overline{y}\right)\) to find the missing data.

[MISSING_PAGE_FAIL:15]

[MISSING_PAGE_EMPTY:16]

**Remark:** In **Examples 6** and **8**, the same data set were used and the regression line of \(y\) on \(x\) and the regression line of \(x\) on \(y\) are drawn on the same\(x\)-\(y\) plane below with \(x\) on the horizontal axis and \(y\) on the vertical axis. Observe that the two lines are different and they **intersect** _at_\(\big{(}\overline{x},\overline{y}\big{)}\).

**Remark:** In **Examples 6** and **8**, the same data set were used and the regression line of \(y\) on \(x\) and the regression line of \(x\) on \(y\) are drawn on the same\(x\)-\(y\) plane below with \(x\) on the horizontal axis and \(y\) on the vertical axis. Observe that the two lines are different and they **intersect** _at_\(\big{(}\overline{x},\overline{y}\big{)}\).

#### Interpolation Vs Extrapolation

**Interpolation** is an estimation of a value within the data range. **Extrapolation** is an estimation of a value outside the data range. In general, we should NOT do extrapolation as there is no way to check if the relationship between \(x\) and \(y\) continues to hold for values that are outside the given data range.

For **interpolation**, there are two reasons to justify that the estimate is _reliable_: \(r\) is close to 1 (or -1), which suggests that there is a strong positive (or negative) linear relationship between the two variables, **and** the given value lies within the data range.

For **extrapolation**, we say that the estimate is _unreliable_ as the given value lies outside the data range, thus the estimate may not be reliable due to extrapolation.

**EXTENSIONS:**

Extrapolation doesn't bode well with regression lines because the best fit lines we create are based on the data collected, so it only represents the behaviour in the region/domain of the data collected.

[MISSING_PAGE_EMPTY:19]

**Self-Review 2:**

A study is done to investigate whether children who spend more time on reading tend to have higher English Literacy scores than children who do not read sufficiently. The table below shows the number of hours spent on reading per week of a sample of 8 children taken when they were 7 years together with the English Literacy scores determined through a test at age 9 years.

\begin{tabular}{|l|c|c|c|c|c|c|c|} \hline Hours spent on reading per week (\(x\)) & 12 & 15 & 8 & 10 & 9 & 6 & 7 \\ \hline English Literacy score (\(y\)) & 85 & 95 & 73 & 79 & 76 & 68 & 70 \\ \hline \end{tabular}

**(a)**: Find the product moment correlation coefficient and the equation of the estimated regression line of \(y\) on \(x\).
**(b)**: Estimate the English Literacy score of a child who spends 11 hours reading per week.
**(c)**: Estimate the hours spent on reading per week at age 7 years given an English literacy score of 78 at age 9 years to 2 decimal places using the regression line of
**(i)**: \(x\) on \(y\),
**(ii)**: \(y\) on \(x\) obtained in **(a)**.

Comment on the values obtained in **(i)** and **(ii)**.

**Solution:**

### Transformation of Data Points from Non-Linear to Linear

Two variables may be governed by a relation that is non-linear. For example, the equation \(y=a+bx^{2}\) indicates that \(y\) and \(x\) are related by a quadratic relationship. However, we can view this equation as \(y\) with respect to \(x^{2}\). If we let \(u=x^{2}\), then \(y=a+bu\) and \(y\) and \(u\) are linearly related. We see that in making a transformation, \(u=x^{2}\), we have changed two variables that are non-linearly related to two variables that are linearly related.

The table below illustrates some suitable examples of transformation on the variables to obtain a linear relationship.

\begin{tabular}{|l|c|c|} \hline
**Equation** & **Independent Variable** & **Dependent Variable** \\ \hline \(y=a+\dfrac{b}{x}\) & \(\dfrac{1}{x}\) & \(y\) \\ \hline \(y=a+bx^{2}\) & \(x^{2}\) & \(y\) \\ \(y^{2}=a+bx\) & \(x\) & \(y^{2}\) \\ \(y^{2}=a+b\ln x\) & \(\ln x\) & \(y\) \\ \(\ln y=a+bx\) & \(x\) & \(\ln y\) \\ \(y^{2}=a^{bx}\) & \(x\) & \(\ln y\) \\ \(\Rightarrow\ln y=\ln a+bx\) & \(x\) & \(\ln y\) \\ \hline \end{tabular}
**Note:**

1. The above list is not exhaustive. The transformation will usually be given in the question.
2. You may be given a scatter diagram and asked to compare two or more proposed models and determine which model is a better fit. Simply state which equation fits the shape of the scatter plot. If there is more than one possibility, compute the product moment correlation coefficient for each model and **break the tie by choosing the model with \(|x|\) closest to 1**.

### Transformation:

By the means of transformation, we are able to achieve linearity, not with the variable directly but with the transformed variable. This allows us to study the statistical relationship between the variables.

**Example 10**:

A research worker gave each of eight children a list of words of varying difficulty and asked them to define the meaning of each word. The following table shows the age in years and the number of correctly defined words for each child.

\begin{tabular}{|l|c|c|c|c|c|c|c|c|} \hline Child & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\ \hline Age, \(x\) (years) & 2.5 & 3.1 & 4.3 & 5.0 & 5.9 & 7.1 & 8.1 & 9.49 \\ \hline Number of correct words, \(y\) & 9 & 13 & 18 & 25 & 35 & 53 & 81 & 132 \\ \hline \end{tabular}

**(a)**: Using a scatter diagram, comment on the suitability of finding the linear regression line of \(y\) on \(x\).
**(b)**: Find the product moment correlation coefficient between \(\ln y\) and \(\ln x\) and sketch the scatter diagram of \(\ln y\) against \(\ln x\). Comment on the suitability of the model \(\ln y=a+b\ln x\).
**(c)**: Find the least-squares regression line of \(\ln y\) on \(\ln x\) and sketch this line on the scatter diagram in **(b)**:

\begin{tabular}{|l|l|} \hline Solution: & **ThinkZone** \\ \hline a) & Be extra alert when \\ keying in values into \\ L\({}_{1}\). The first row in the \\ given table \{1, 2, \\
3,..., 8\} \\ is not the variable. \\ \end{tabular}

The correct list should be \(\{2.5,\,3.1,\,\ldots,\,9.49\}\).
**(b)**: The scatter diagram shows that as \(x\) increases, \(y\) increases at an _increasing rate_. This agrees with the model \(\ln y=a+b\ln x\). Also, \(r=0.982\) is very close to 1, which shows a strong positive linear relationship between the variables \(\ln x\) and \(\ln y\). Hence the model \(\ln y=a+b\ln x\) is suitable.
**(c)**: By GC, the regression line of \(\ln y\) on \(\ln x\) is \(\ln y=1.948\ln x+0.247\).

See **ANNEX** for the GC keystrokes

**Example 11**: The amount of a chemical, \(x\) (in grams), varies with time, \(t\) (in minutes) for which a particular chemical reaction has taken place and is given by the formula \(x=x_{0}\mathrm{e}^{-\mu}\), where \(x_{0}\) and \(k\) are constants. The values of \(t\) may be considered to be exact, while the values of \(x\) are subject to experimental error.

\begin{tabular}{|c|c|c|c|c|c|} \hline Time, \(t\) & 0.2 & 0.4 & 0.6 & 0.8 & 1.0 \\ \hline Amount, \(x\) & 3.22 & 1,63 & 0.89 & 0.41 & 0.36 \\ \hline \end{tabular}

The variable \(y\) is defined by \(y=\ln x\).

**(a)**: Using a least-squares method, calculate the equation of the appropriate regression line and hence give estimates of \(x_{0}\) and \(k\).
**(b)**: From the equation, estimate the decrease in \(y\) when \(t\) increases by 1.
**(c)**: Use the regression line obtained in **(a)** to give the best estimate of \(t\) when \(x=1.5\).

Comment briefly on the reliability of the estimate.

**Solution:**

**(a)**: \(x=x_{0}\mathrm{e}^{-\mu}\)

\(\ln x=\ln\left(x_{0}\mathrm{e}^{-\mu}\right)\)

\(=\ln x_{0}+\ln\mathrm{e}^{-\mu}\)

\(=\ln x_{0}-kt\)

By GC, \(\ln x=-2.881\ln+1.6543\)

Hence \(-k=-2.8811\Rightarrow k=2.88\) (3 s.f.)

and \(\ln x_{0}=1.6543\Rightarrow x_{0}=\mathrm{e}^{1.6543}=5.23\) (3 s.f.)

**(b)**: When \(t\) increases by \(1,y\) is expected to decrease by approximately \(2.88\).
**(c)**: When \(x=1.5\), \(y=\ln\left(1.5\right)\).

Using the equation of the regression line of \(y\) on \(t\), the estimated value of \(t\) is \(0.433\).

Since \(r=-0.984\), which is very close to \(-1\) and

\(x=1.5\) is within the data range,

we can use the regression line of \(y\) on \(t\) to obtain an estimate of \(t\). Thus, the estimate is likely to be reliable.

**Chapter S8 Correlation and Regression**

**Example 12**

A student wishes to determine the relationship between the length of a pendulum, \(l\), and the corresponding period, \(T\). After conducting the experiment, he obtained the following set of data:

\begin{tabular}{|l|c|c|c|c|c|c|c|c|c|c|} \hline \(l\) (cm) & 150 & 135 & 120 & 105 & 90 & 75 & 60 & 45 & 30 & 15 \\ \hline \(T\) (s) & 2.45 & 2.31 & 2.22 & 2.07 & 1.91 & 1.74 & 1.56 & 1.35 & 1.10 & 0.779 \\ \hline \end{tabular}

**(a)**: Obtain a scatter diagram of this set of data.
**(b)**: The student proposes the following two models:

\[A\colon\ T=a+b\ln\left(l\right)\]

\[B\colon\ T^{2}=a+bl.\]
**(i)**: Calculate the product moment correlation coefficient for both models, giving your answers to 4 decimal places.
**(ii)**: Determine which model is appropriate for this set of data.
**(c)**: Using the model determined in **(b)** part **(ii)**, estimate the value of \(l\) when \(T=3\) to 1 decimal place. Comment on the suitability of this method.
**(d)**: Find a value of \(l\) and its corresponding value of \(T\) such that the equation of the regression line for the chosen model will remain the same after the addition of this pair of values.

**Solution:**

**(a)**: 

**(b)(i)**: Using GC, for model \(A\), \(r=0.9871\)

for model \(B\), \(r=0.9996\).
**(ii)**: Since \(0.9996\) \(>0.9871\), model \(B\) indicates a stronger positive linear correlation between \(l\) and \(T^{2}\) than the linear correlation between \(\ln\left(l\right)\) and \(T\) of model \(A\). Hence, model \(B\) is an appropriate model.
**(c)**: Using model \(B\), the regression line of \(T^{2}\) on \(l\) is \(T^{2}=0.025136+0.040060l\).
**When \(T=3\), \(3^{2}=0.025136+0.040060l\). Hence \(l=224.0\). Using the regression line may not be appropriate as \(T=3\) is not within the data range even though \(r\) is close 1.**(d)**: Note that \(\left(\overline{l},\overline{T^{2}}\right)\) is the _only_ point that we can safely add to the set of data points and not change the regression line. By GC, we find that \(\overline{l}=82.5\) and \(\overline{T^{2}}=3.3300541\)

Thus, \(l=82.5\) and \(T=\sqrt{3.3300541}\approx 1.82\).

**(a)**: Obtain a scatter diagram of this set of data.
**(b)**: The student proposes the following two models:

\[A\colon\ T=a+b\ln\left(l\right)\]

\[B\colon\ T^{2}=a+bl.\]
**(i)**: Calculate the product moment correlation coefficient for both models, giving your answers to 4 decimal places.
**(ii)**: Determine which model is appropriate for this set of data.
**(c)**: Using the model determined in **(b)** part **(ii)**, estimate the value of \(l\) when \(T=3\) to 1 decimal place. Comment on the suitability of this method.
**(d)**: Find a value of \(l\) and its corresponding value of \(T\) such that the equation of the regression line for the chosen model will remain the same after the addition of this pair of values.

**Solution:**

**(a)**: 

**(b)(i)**: Using GC, for model \(A\), \(r=0.9871\)

for model \(B\), \(r=0.9996\).
**(ii)**: Since \(0.9996\) \(>0.9871\), model \(B\) indicates a stronger positive linear correlation between \(l\) and \(T^{2}\) than the linear correlation between \(\ln\left(l\right)\) and \(T\) of model \(A\). Hence, model \(B\) is an appropriate model.
**(c)**: Using model \(B\), the regression line of \(T^{2}\) on \(l\)

**Chapter S8 Correlation and Regression**

**Note:** For any set of data, adding the point \(\left(\overline{x},\overline{y}\right)\) will not alter the equation of the regression line of \(y\) on \(x\) and the equation of the regression line of \(x\) on \(y\).

**Summary:**

\begin{tabular}{|l|l|} \hline a. & We first determine using a scatter diagram that a **linear** relationship between the variables \(x\) and \(y\) exist. \\ \hline b. & For a regression line \(y\) on \(x\), \(x\) is taken as the **independent** variable and \(y\) as the **dependent** variable. \\  & For a regression line \(x\) on \(y\), \(y\) is taken as the **independent** variable and \(x\) as the **dependent** variable. \\ \hline c. & When it is not obvious which is the independent or dependent variable, then, \\  & If you are given \(x\) and asked to _estimate_\(y\), use the regression line \(y\)_on_\(x\). \\  & If you are given \(y\) and asked to _estimate_\(x\), use the regression line \(x\)_on_\(y\) \\ \hline d. & If it is clear from the question that \(x\) is the independent variable (e.g. controlled variable), \\  & while \(y\) is the dependent variable, then **there is only one regression line \(y\) on \(x\)**. \\  & (Note: you should not find regression line \(x\) on \(y\) in this case) \\ e. & Uses of the regression line of \(y\) on \(x\): \\  & Should only be used to estimate values of \(y\) within the range of values of \(x\) used in calculating the regression line (Interpolation), \\  & Extrapolation **should not** be used as we have no way of knowing the relationship between \(x\) and \(y\) that are not in the data range. \\  & Commenting on reliability of estimates: \\  & Estimates obtained from the least squares regression lines are reliable if the given values are within the data range and \(r\) is close to \(\bar{1}\) or \(\bar{1}\). \\  & Estimates obtained from extrapolation are not reliable. \\ \hline f. & Both regression lines of \(y\) on \(x\) and \(x\) on \(y\) will pass through the point \(\left(\overline{x},\overline{y}\right)\). \\ \hline g. & If the scatter diagram reveals a non-linear relationship between two variables \(x\) and \(y\), say of the form, \(y=a+b\,\mathrm{f}\left(x\right)\), then it is possible to introduce a new variable \(u=\mathrm{f}\left(x\right)\) so that the equation becomes \(y=a+bu\) which is linear in \(u\) and \(y\). \\ \hline h. & Given a few non-linear models, we first use the scatter diagram to determine which is the appropriate model. If two or more models are applicable, then the model such that \(\left|r\right|\) is the largest after transformation to a linear equation is in general the best model. \\ \hline \end{tabular}

**ACNEX**

**GC Keystrokes for Example 10**

To use the GC to transform the data and obtain the regression line of \(\ln y\) on \(\ln x\).

\begin{tabular}{|l|} \hline Press [stat] and highlight '**1:Edit...'** and press [enter]. Key in the values of \(x\) and \(y\) into \(\mathrm{L}_{1}\) and \(\mathrm{L}_{2}\) respectively, \\ \hline In cell \(\mathrm{L}_{3}\), key in "**\(\ln\left(\mathrm{L}_{1}\right)\)** and press [enter]. \\ \hline The command " is to ensure that the GC stores the formula. " can be found on the '+' button. \\ \hline Notice that there is a black icon in the header of \(\mathrm{L}_{3}\) to indicate that a formula is stored. When the cursor is moved to \(\mathrm{L}_{3}\), the formula "\(\ln\left(\mathrm{L}_{1}\right)\)" will appear below the screen to indicate that \(\mathrm{L}_{3}=\ln\left(\mathrm{L}_{1}\right)\). If " is omitted when keying in "\(\ln\left(\mathrm{L}_{1}\right)\)" in \(\mathrm{L}_{3}\), the formula will not stored. \\ \hline Press [stat], highlight '**CALC**' and select '**4:LinReg(ax+b)**' and press [enter]. \\ \hline To obtain the product moment correlation coefficient between \(\ln y\) and \(\ln x\), we key in'\(\mathrm{L}_{3}\), in '**Xlist:**' and'\(\mathrm{L}_{4}\) in '**Ylist**'. We then scroll down to '**Calculate**' and press [enter]. \\ \hline By GC, \(r=0.982\). \\ \(\ln y=1.948\ln x+0.247\) \\ \hline \end{tabular}

Since \(r=0.982\) is very close to 1 and also based on the scatter diagram, we can say that the model \(\ln y=a+b\ln x\) is suitable.

**Note:**

You will need to plot \(\mathrm{L}_{4}\) against \(\mathrm{L}_{3}\) in your GC to see that \(\ln x\) and \(\ln y\) are linearly related.

**GSC Keystrokes for Example 11**

To use the GC to transform the data and obtain the regression line of ln\(x\) on \(t\).

\begin{tabular}{|l|} \hline Press [stat] and highlight '**1:Edit...**' and press [enter]. Key in the values of \(t\) and \(x\) into L\({}_{1}\) and L\({}_{2}\) respectively, \\ In cell \(\,\)L\({}_{3}\,\), key in '\(\ln\left(\text{L}_{2}\right)\,\)' and press [enter]. \\ \hline \end{tabular}

[MISSING_PAGE_POST]

\begin{tabular}{|l|} \hline Process [stat], highlight '**CALC** and select '**4:LinReg(ax+b)**' and press [enter].

[MISSING_PAGE_EMPTY:28]